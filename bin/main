#!/usr/bin/env ruby

require_relative '../lib/board.rb'
require_relative '../lib/player.rb'
require_relative '../lib/tictactoe.rb'

# Game user interface

flag = 'Y'

while flag == 'Y'

  game = TicTacToe.new

  puts 'Hi, Welcome to TicTacToe game'

  puts 'Insert name of two players: '

  # Creating player object

  players = game.create_players(gets.chomp.to_s, gets.chomp.to_s)

  puts "Hi #{players[0].name} and #{players[1].name}, welcome to tictactoe game: "

  game.create_board

  game.print_board

  puts "Ok #{players[0].name} please pick your symbol: "

  sym1 = gets.chomp.to_s

  puts "Ok #{players[1].name} please pick your symbol: "

  sym2 = gets.chomp.to_s

  game.pick_symbol(sym1, sym2)

  puts "#{players[0].name} choses #{players[0].sym}"
  puts "#{players[1].name} choses #{players[1].sym}"

  i = 0

  puts 'Game is ready. Now pick the player for the first move: '

  game.set_beginner

  puts "#{players[0].name} will start'"

  while i < 9

    current_player = game.put_current_player(i)
    game.put_next_player(i)

    puts "@ #{current_player.name}, now your turn. Pick a cell which has available spot: "

    game.print_board

    pick = gets.chomp.to_i - 1

    while game.check_move(pick)
      puts 'wrong input. Please pick another cell no.: '
      pick = gets.chomp.to_i - 1
    end

    game.update_board(pick)

    game.print_board

    game_flag = 0

    if i == 6 || i == 7 then 
      puts game.draw_move? 
    end 

    if game.win_move? == true
      puts 'You made the winning move. You won!!!'
      game_flag = 1
    elsif  [6, 7].include?(i) && game.draw_move? == true  
      puts 'Game ends with draw result'
    else
      puts "You picked cell no. #{pick + 1}"
    end

    break unless game_flag.zero?

    i += 1
  end

  puts 'Game is over. Would you like to continuue? (Y) or quit? (N): '

  flag = gets.chomp.to_s

end
